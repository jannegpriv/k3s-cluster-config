apiVersion: monitoring.coreos.com/v1alpha1
kind: AlertmanagerConfig
metadata:
  name: main-rules-alert-config
  namespace: monitoring
  labels:
    alertmanagerConfig: "true"
spec:
  route:
    receiver: 'email'
    groupBy: ['alertname', 'severity']
    groupInterval: 5m
    repeatInterval: 4h
    matchers:
      - name: severity
        matchType: =~
        value: "warning|critical"
  receivers:
    - name: 'email'
      emailConfigs:
        - to: 'jannegpriv@gmail.com'
          from: 'jannegpriv@gmail.com'
          smarthost: 'smtp-relay.brevo.com:587'
          authUsername: '85deaf001@smtp-brevo.com'
          authIdentity: '85deaf001@smtp-brevo.com'
          authType: LOGIN
          authSecret:
            name: alertmanager-notification-secret
            key: password
          requireTLS: true
